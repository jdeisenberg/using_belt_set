
    
<!doctype html>
<meta charset=utf8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel=stylesheet href='./styles.css'>
<script defer src='./script.js'></script>
<title>Home</title>
<body>
<script>window.relativeToRoot="."</script>
<script defer src="./block-script.js"></script>
<div id='error-message'>
  ⚠️ Oops! This page doesn't appear to define a <span>type</span> called <code>_</code>.
</div>

    
    <div class='container'>
    
    <div class='sidebar-wrapper'>
    <div class='sidebar-expander'>Show navigation</div>
    <div class='sidebar'>
      <a href="./search.html" style="display: block; padding: 0 8px;">Search</a>
      <div class='docs-listing'><a href="./index.html">Home</a></div>
      <div class='table-of-contents'>
      <div class='toc-header'>Page Contents</div>
      <a href="#using-belt.set-with-variant-data-types" class='level-1 header'>Using <code>Belt.Set</code> with Variant Data Types</a>
<a href="#sets-in-reasonml" class='level-2 header'>Sets in ReasonML</a>
<a href="#customized-sets" class='level-2 header'>Customized Sets</a>
<a href="#challenge-1" class='level-3 header'>Challenge 1</a>
<a href="#challenge-2" class='level-3 header'>Challenge 2</a>
<a href="#variants-with-constructors" class='level-2 header'>Variants With Constructors</a>
<a href="#conclusion" class='level-2 header'>Conclusion</a>
      </div>
      <div class='project-listing'><div class='project-title'>Package modules</div><a href="./api/IntSetExample-Usingbeltset.html">IntSetExample-Usingbeltset</a>
<a href="./api/WeekdayExample-Usingbeltset.html">WeekdayExample-Usingbeltset</a>
<a href="./api/Fraction-Usingbeltset.html">Fraction-Usingbeltset</a>
<a href="./api/ColourExample-Usingbeltset.html">ColourExample-Usingbeltset</a>
<a href="./api/IntSetExample-Usingbeltset.html">IntSetExample-Usingbeltset</a>
<a href="./api/WeekdayExample-Usingbeltset.html">WeekdayExample-Usingbeltset</a>
<a href="./api/Fraction-Usingbeltset.html">Fraction-Usingbeltset</a>
<a href="./api/ColourExample-Usingbeltset.html">ColourExample-Usingbeltset</a></div>
    </div>
    </div>
  
    <div class='main'>
    
    <a href="#using-belt.set-with-variant-data-types" id="using-belt.set-with-variant-data-types"><h1>Using <code>Belt.Set</code> with Variant Data Types</h1></a>

<p>Consider a data type that gives the work days of the week, used in a data type that specifies a
course in a school:</p>


<div class='code-block'>
  
  <pre class='code' data-block-id='0' id='block-0'><code>type weekday =
  | M
  | T
  | W
  | Th
  | F;
  
  
type course = {
  subject: <span class='type-constructor'>string</span>,
  room: <span class='type-constructor'>string</span>,
  days: <span class='type-constructor'>array</span>(<span class='type-constructor'>weekday</span>)
};</code></pre>
  
  <script type='docre-source' data-block-id="0">type weekday =
  | M
  | T
  | W
  | Th
  | F;
  
  
type course = {
  subject: string,
  room: string,
  days: array(weekday)
};</script>
  
</div><p>Given an array of courses and a set of requested days...</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='1' id='block-1'><code>let <span class='pattern-ident' data-type="array(course)">courses</span> = [|
  <span data-type="course">{subject: <span class='string' data-type="string">&quot;Math&quot;</span>, room: <span class='string' data-type="string">&quot;C101&quot;</span>, days: [| <span class='constructor' data-type="weekday">M</span>, <span class='constructor' data-type="weekday">W</span> |]}</span>,
  <span data-type="course">{subject: <span class='string' data-type="string">&quot;Art&quot;</span>, room: <span class='string' data-type="string">&quot;VPA203&quot;</span>, days: [| <span class='constructor' data-type="weekday">T</span>, <span class='constructor' data-type="weekday">Th</span> |]}</span>,
  <span data-type="course">{subject: <span class='string' data-type="string">&quot;Psychology&quot;</span>, room: <span class='string' data-type="string">&quot;A5-212&quot;</span>, days: [|<span class='constructor' data-type="weekday">M</span>, <span class='constructor' data-type="weekday">Th</span>, <span class='constructor' data-type="weekday">F</span> |]}</span>,
|];

let <span class='pattern-ident' data-type="array(weekday)">requested</span> = [|<span class='constructor' data-type="weekday">T</span>, <span class='constructor' data-type="weekday">W</span>|];</code></pre>
  
  <script type='docre-source' data-block-id="1">#type weekday =
#  | M
#  | T
#  | W
#  | Th
#  | F;
#  
#type course = {
#  subject: string,
#  room: string,
#  days: array(weekday)
#};
#let courses = [|
#  {subject: "Math", room: "C101", days: [| M, W |]},
#  {subject: "Art", room: "VPA203", days: [| T, Th |]},
#  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
#|];
#
#let requested = [|T, W|];
#module DayComparator =
#  Belt.Id.MakeComparable(
#    {
#      type t = weekday;
#      let cmp = compare;
#    },
#  );
let courses = [|
  {subject: "Math", room: "C101", days: [| M, W |]},
  {subject: "Art", room: "VPA203", days: [| T, Th |]},
  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
|];

let requested = [|T, W|];</script>
  
</div>

<p>...you might want to write code that will find rooms that are in use on any of the requested days. This is a perfect case
for using <em>set</em>s. If the intersection of a course’s <code>days</code> and the <code>requested</code> days is not empty, then
the course’s <code>room</code> is occupied.</p>
<a href="#sets-in-reasonml" id="sets-in-reasonml"><h2>Sets in ReasonML</h2></a>

<p>The new <code>Belt</code> library has a <code>Belt.Set</code> module, which implements sorted, immutable sets. That is, the items in the set are stored in sorted order, and all set functions create a new set; the original is never changed (immutable).</p>
<p>For integers, strings, and dictionaries, <code>Belt</code> provides specialized modules: <code>Belt.SetInt</code>, <code>Belt.SetString</code>, and <code>Belt.SetDict</code>. Here is an example of using <code>Belt.SetInt</code>.</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='2' id='block-2'><code>let <span class='pattern-ident' data-type="Belt.Set.Int.t">items</span> = <span class='ident' data-type="array(Belt.Set.Int.value) => Belt.Set.Int.t">Belt.Set.Int.fromArray</span>([|<span class='int' data-type="Belt.Set.Int.value">3</span>, <span class='int' data-type="Belt.Set.Int.value">5</span>, <span class='int' data-type="Belt.Set.Int.value">2</span>, <span class='int' data-type="Belt.Set.Int.value">5</span>, <span class='int' data-type="Belt.Set.Int.value">4</span>, <span class='int' data-type="Belt.Set.Int.value">6</span>, <span class='int' data-type="Belt.Set.Int.value">2</span>|]);
let <span class='pattern-ident' data-type="Belt.Set.Int.t">odds</span> = <span class='ident' data-type="array(Belt.Set.Int.value) => Belt.Set.Int.t">Belt.Set.Int.fromArray</span>([|<span class='int' data-type="Belt.Set.Int.value">1</span>, <span class='int' data-type="Belt.Set.Int.value">3</span>, <span class='int' data-type="Belt.Set.Int.value">5</span>, <span class='int' data-type="Belt.Set.Int.value">7</span>|]);
let <span class='pattern-ident' data-type="Belt.Set.Int.t">union</span> = <span class='ident' data-type="(Belt.Set.Int.t, Belt.Set.Int.t) => Belt.Set.Int.t">Belt.Set.Int.union</span>(<span class='ident' data-type="Belt.Set.Int.t">items</span>, <span class='ident' data-type="Belt.Set.Int.t">odds</span>);
let <span class='pattern-ident' data-type="Belt.Set.Int.t">both</span> = <span class='ident' data-type="(Belt.Set.Int.t, Belt.Set.Int.t) => Belt.Set.Int.t">Belt.Set.Int.intersect</span>(<span class='ident' data-type="Belt.Set.Int.t">items</span>, <span class='ident' data-type="Belt.Set.Int.t">odds</span>);
let <span class='pattern-ident' data-type="Belt.Set.Int.t">diff</span> = <span class='ident' data-type="(Belt.Set.Int.t, Belt.Set.Int.t) => Belt.Set.Int.t">Belt.Set.Int.diff</span>(<span class='ident' data-type="Belt.Set.Int.t">items</span>, <span class='ident' data-type="Belt.Set.Int.t">odds</span>);

<span class='ident' data-type="(string, array(Belt.Set.Int.value)) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;Union:&quot;</span>, <span class='ident' data-type="Belt.Set.Int.t => array(Belt.Set.Int.value)">Belt.Set.Int.toArray</span>(<span class='ident' data-type="Belt.Set.Int.t">union</span>));
<span class='ident' data-type="(string, array(Belt.Set.Int.value)) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;Intersection:&quot;</span>, <span class='ident' data-type="Belt.Set.Int.t => array(Belt.Set.Int.value)">Belt.Set.Int.toArray</span>(<span class='ident' data-type="Belt.Set.Int.t">both</span>));
<span class='ident' data-type="(string, array(Belt.Set.Int.value)) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;Difference:&quot;</span>, <span class='ident' data-type="Belt.Set.Int.t => array(Belt.Set.Int.value)">Belt.Set.Int.toArray</span>(<span class='ident' data-type="Belt.Set.Int.t">diff</span>));
<span class='ident' data-type="(string, bool) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;Union empty?:&quot;</span>, <span class='ident' data-type="Belt.Set.Int.t => bool">Belt.Set.Int.isEmpty</span>(<span class='ident' data-type="Belt.Set.Int.t">union</span>));</code></pre>
  
  <script type='docre-source' data-block-id="2">let items = Belt.Set.Int.fromArray([|3, 5, 2, 5, 4, 6, 2|]);
let odds = Belt.Set.Int.fromArray([|1, 3, 5, 7|]);
let union = Belt.Set.Int.union(items, odds);
let both = Belt.Set.Int.intersect(items, odds);
let diff = Belt.Set.Int.diff(items, odds);

Js.log2("Union:", Belt.Set.Int.toArray(union));
Js.log2("Intersection:", Belt.Set.Int.toArray(both));
Js.log2("Difference:", Belt.Set.Int.toArray(diff));
Js.log2("Union empty?:", Belt.Set.Int.isEmpty(union));</script>
  <div data-block-id='2' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='2'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Belt_SetInt = window.packRequire("./node_modules/bs-platform/lib/js/belt_SetInt.js");

var items = Belt_SetInt.fromArray(/* array */[
      3,
      5,
      2,
      5,
      4,
      6,
      2
    ]);

var odds = Belt_SetInt.fromArray(/* int array */[
      1,
      3,
      5,
      7
    ]);

var union = Belt_SetInt.union(items, odds);

var both = Belt_SetInt.intersect(items, odds);

var diff = Belt_SetInt.diff(items, odds);

console.log("Union:", Belt_SetInt.toArray(union));

console.log("Intersection:", Belt_SetInt.toArray(both));

console.log("Difference:", Belt_SetInt.toArray(diff));

console.log("Union empty?:", Belt_SetInt.isEmpty(union));

exports.items = items;
exports.odds = odds;
exports.union = union;
exports.both = both;
exports.diff = diff;
/* items Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_2.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_2.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div><p>You almost never need to know the internal form of a set; as in the preceding example you will usually build a set <code>fromArray</code> and convert it back <code>toArray</code> when you finish set operations.</p>
<a href="#customized-sets" id="customized-sets"><h2>Customized Sets</h2></a>

<p>In the example of the courses, you need sets of <code>weekday</code>, which aren’t integers, strings, or dictionaries. In order to create these sets, you have to tell the main <code>Belt.Set</code> module how to compare days of the week. The first question is: can you even compare variant data types? Yes, you can, with ReasonML’s <code>compare</code> function. This function takes two arguments and returns <code>-1</code> if the first argument is less than the second, <code>0</code> if the arguments are equal, and <code>1</code> if the first argument is greater than the second:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='3' id='block-3'><code><span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(int, int) => int">compare</span>(<span class='int' data-type="int">3</span>, <span class='int' data-type="int">5</span>));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(int, int) => int">compare</span>(<span class='int' data-type="int">3</span>, <span class='int' data-type="int">3</span>));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(int, int) => int">compare</span>(<span class='int' data-type="int">5</span>, <span class='int' data-type="int">3</span>));

<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(weekday, weekday) => int">compare</span>(<span class='constructor' data-type="weekday">M</span>, <span class='constructor' data-type="weekday">W</span>));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(weekday, weekday) => int">compare</span>(<span class='constructor' data-type="weekday">W</span>, <span class='constructor' data-type="weekday">W</span>));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(weekday, weekday) => int">compare</span>(<span class='constructor' data-type="weekday">F</span>, <span class='constructor' data-type="weekday">W</span>));</code></pre>
  
  <script type='docre-source' data-block-id="3">#type weekday =
#  | M
#  | T
#  | W
#  | Th
#  | F;
#  
#type course = {
#  subject: string,
#  room: string,
#  days: array(weekday)
#};
#let courses = [|
#  {subject: "Math", room: "C101", days: [| M, W |]},
#  {subject: "Art", room: "VPA203", days: [| T, Th |]},
#  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
#|];
#
#let requested = [|T, W|];
#module DayComparator =
#  Belt.Id.MakeComparable(
#    {
#      type t = weekday;
#      let cmp = compare;
#    },
#  );
Js.log(compare(3, 5));
Js.log(compare(3, 3));
Js.log(compare(5, 3));

Js.log(compare(M, W));
Js.log(compare(W, W));
Js.log(compare(F, W));</script>
  <div data-block-id='3' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='3'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Belt_Id = window.packRequire("./node_modules/bs-platform/lib/js/belt_Id.js");
var Caml_obj = window.packRequire("./node_modules/bs-platform/lib/js/caml_obj.js");
var Caml_primitive = window.packRequire("./node_modules/bs-platform/lib/js/caml_primitive.js");

var courses = /* array */[
  /* record */[
    /* subject */"Math",
    /* room */"C101",
    /* days : int array */[
      /* M */0,
      /* W */2
    ]
  ],
  /* record */[
    /* subject */"Art",
    /* room */"VPA203",
    /* days : int array */[
      /* T */1,
      /* Th */3
    ]
  ],
  /* record */[
    /* subject */"Psychology",
    /* room */"A5-212",
    /* days : int array */[
      /* M */0,
      /* Th */3,
      /* F */4
    ]
  ]
];

var requested = /* int array */[
  /* T */1,
  /* W */2
];

var cmp = Caml_obj.caml_compare;

var DayComparator = Belt_Id.MakeComparable(/* module */[/* cmp */cmp]);

console.log(Caml_primitive.caml_int_compare(3, 5));

console.log(Caml_primitive.caml_int_compare(3, 3));

console.log(Caml_primitive.caml_int_compare(5, 3));

console.log(Caml_primitive.caml_int_compare(/* M */0, /* W */2));

console.log(Caml_primitive.caml_int_compare(/* W */2, /* W */2));

console.log(Caml_primitive.caml_int_compare(/* F */4, /* W */2));

exports.courses = courses;
exports.requested = requested;
exports.DayComparator = DayComparator;
/* DayComparator Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_3.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_3.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div><p>To tell <code>Belt.Set</code> how to compare a custom type, you create a module that includes a call to <code>Belt.Id.MakeComparable</code> that specifies:</p>
<ul><li>The data type <code>t</code> being compared</li><li>A function <code>cmp</code> that does a comparison, returning <code>-1</code>, <code>0</code>, or <code>1</code> for less than, equal, or greater than.</li></ul>

<p>Here is the code for comparing days of the week:</p>
<pre class='txt'><code class='txt'>module DayComparator =
  Belt.Id.MakeComparable(
    {
      type t = weekday;
      let cmp = compare;
    },
  );</code></pre>

<p>When creating a set of <code>weekday</code>s from an array, you need to specify the comparator to use:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='4' id='block-4'><code>let <span class='pattern-ident' data-type="Belt.Set.t(weekday, DayComparator.identity)">requestedSet</span> =
  <span class='ident' data-type="(
    array(weekday),
    ~id: Belt.Set.id(
        weekday,
        DayComparator.identity
    )
) => Belt.Set.t(weekday, DayComparator.identity)">Belt.Set.fromArray</span>(<span class='ident' data-type="array(weekday)">requested</span>, ~id=(module DayComparator));
<span class='ident' data-type="array(weekday) => unit">Js.log</span>(<span class='ident' data-type="Belt.Set.t(weekday, DayComparator.identity) => array(
    weekday
)">Belt.Set.toArray</span>(<span class='ident' data-type="Belt.Set.t(weekday, DayComparator.identity)">requestedSet</span>));</code></pre>
  
  <script type='docre-source' data-block-id="4">#type weekday =
#  | M
#  | T
#  | W
#  | Th
#  | F;
#  
#type course = {
#  subject: string,
#  room: string,
#  days: array(weekday)
#};
#let courses = [|
#  {subject: "Math", room: "C101", days: [| M, W |]},
#  {subject: "Art", room: "VPA203", days: [| T, Th |]},
#  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
#|];
#
#let requested = [|T, W|];
#module DayComparator =
#  Belt.Id.MakeComparable(
#    {
#      type t = weekday;
#      let cmp = compare;
#    },
#  );
let requestedSet =
  Belt.Set.fromArray(requested, ~id=(module DayComparator));
Js.log(Belt.Set.toArray(requestedSet));</script>
  <div data-block-id='4' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='4'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Belt_Id = window.packRequire("./node_modules/bs-platform/lib/js/belt_Id.js");
var Belt_Set = window.packRequire("./node_modules/bs-platform/lib/js/belt_Set.js");
var Caml_obj = window.packRequire("./node_modules/bs-platform/lib/js/caml_obj.js");

var courses = /* array */[
  /* record */[
    /* subject */"Math",
    /* room */"C101",
    /* days : int array */[
      /* M */0,
      /* W */2
    ]
  ],
  /* record */[
    /* subject */"Art",
    /* room */"VPA203",
    /* days : int array */[
      /* T */1,
      /* Th */3
    ]
  ],
  /* record */[
    /* subject */"Psychology",
    /* room */"A5-212",
    /* days : int array */[
      /* M */0,
      /* Th */3,
      /* F */4
    ]
  ]
];

var requested = /* int array */[
  /* T */1,
  /* W */2
];

var cmp = Caml_obj.caml_compare;

var DayComparator = Belt_Id.MakeComparable(/* module */[/* cmp */cmp]);

var requestedSet = Belt_Set.fromArray(requested, DayComparator);

console.log(Belt_Set.toArray(requestedSet));

exports.courses = courses;
exports.requested = requested;
exports.DayComparator = DayComparator;
exports.requestedSet = requestedSet;
/* DayComparator Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_4.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_4.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div>

<p>(The output from the preceding example shows the numeric values assigned to the variants; ReasonML uses the names during compile time, not during run time.)</p>
<p>That now lets you write the following code to do the task of finding the empty rooms.</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='5' id='block-5'><code>module Set = Belt.Set; /* an alias to save typing */
let <span class='pattern-ident' data-type="Set.t(weekday, DayComparator.identity)">requestedSet</span> =
  <span class='ident' data-type="(
    array(weekday),
    ~id: Set.id(weekday, DayComparator.identity)
) => Set.t(weekday, DayComparator.identity)">Set.fromArray</span>(<span class='ident' data-type="array(weekday)">requested</span>, ~id=(module DayComparator));

let <span class='pattern-ident' data-type="array(string)">rooms</span> = <span class='ident' data-type="(array(course), course => option(string)) => array(string)">Belt.Array.keepMap</span>(<span class='ident' data-type="array(course)">courses</span>, <span class='pattern-ident' data-type="course">item</span> =&gt; {
  let <span class='pattern-ident' data-type="Set.t(weekday, DayComparator.identity)">daySet</span> = <span class='ident' data-type="(
    array(weekday),
    ~id: Set.id(weekday, DayComparator.identity)
) => Set.t(weekday, DayComparator.identity)">Set.fromArray</span>(<span class='ident' data-type="course">item</span>.<span class='field' data-type="array(weekday)">days</span>, ~id=(module DayComparator));
  if (<span class='ident' data-type="Set.t(weekday, DayComparator.identity) => bool">Set.isEmpty</span>(<span class='ident' data-type="(
    Set.t(weekday, DayComparator.identity),
    Set.t(weekday, DayComparator.identity)
) => Set.t(weekday, DayComparator.identity)">Set.intersect</span>(<span class='ident' data-type="Set.t(weekday, DayComparator.identity)">daySet</span>, <span class='ident' data-type="Set.t(weekday, DayComparator.identity)">requestedSet</span>))) {
    <span class='constructor' data-type="option(string)">None</span>;
  } else {
    <span class='constructor' data-type="option(string)">Some</span>(<span class='ident' data-type="course">item</span>.<span class='field' data-type="string">room</span>);
  }
});
<span class='ident' data-type="array(string) => unit">Js.log</span>(<span class='ident' data-type="array(string)">rooms</span>);</code></pre>
  
  <script type='docre-source' data-block-id="5">#type weekday =
#  | M
#  | T
#  | W
#  | Th
#  | F;
#  
#type course = {
#  subject: string,
#  room: string,
#  days: array(weekday)
#};
#let courses = [|
#  {subject: "Math", room: "C101", days: [| M, W |]},
#  {subject: "Art", room: "VPA203", days: [| T, Th |]},
#  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
#|];
#
#let requested = [|T, W|];
#module DayComparator =
#  Belt.Id.MakeComparable(
#    {
#      type t = weekday;
#      let cmp = compare;
#    },
#  );
module Set = Belt.Set; /* an alias to save typing */
let requestedSet =
  Set.fromArray(requested, ~id=(module DayComparator));

let rooms = Belt.Array.keepMap(courses, item => {
  let daySet = Set.fromArray(item.days, ~id=(module DayComparator));
  if (Set.isEmpty(Set.intersect(daySet, requestedSet))) {
    None;
  } else {
    Some(item.room);
  }
});
Js.log(rooms);</script>
  <div data-block-id='5' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='5'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Belt_Id = window.packRequire("./node_modules/bs-platform/lib/js/belt_Id.js");
var Belt_Set = window.packRequire("./node_modules/bs-platform/lib/js/belt_Set.js");
var Caml_obj = window.packRequire("./node_modules/bs-platform/lib/js/caml_obj.js");
var Belt_Array = window.packRequire("./node_modules/bs-platform/lib/js/belt_Array.js");

var courses = /* array */[
  /* record */[
    /* subject */"Math",
    /* room */"C101",
    /* days : int array */[
      /* M */0,
      /* W */2
    ]
  ],
  /* record */[
    /* subject */"Art",
    /* room */"VPA203",
    /* days : int array */[
      /* T */1,
      /* Th */3
    ]
  ],
  /* record */[
    /* subject */"Psychology",
    /* room */"A5-212",
    /* days : int array */[
      /* M */0,
      /* Th */3,
      /* F */4
    ]
  ]
];

var requested = /* int array */[
  /* T */1,
  /* W */2
];

var cmp = Caml_obj.caml_compare;

var DayComparator = Belt_Id.MakeComparable(/* module */[/* cmp */cmp]);

var requestedSet = Belt_Set.fromArray(requested, DayComparator);

var rooms = Belt_Array.keepMap(courses, (function (item) {
        var daySet = Belt_Set.fromArray(item[/* days */2], DayComparator);
        if (Belt_Set.isEmpty(Belt_Set.intersect(daySet, requestedSet))) {
          return /* None */0;
        } else {
          return /* Some */[item[/* room */1]];
        }
      }));

console.log(rooms);

var $$Set = 0;

exports.courses = courses;
exports.requested = requested;
exports.DayComparator = DayComparator;
exports.$$Set = $$Set;
exports.requestedSet = requestedSet;
exports.rooms = rooms;
/* DayComparator Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_5.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_5.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div>

<p>A quick explanation of <code>Belt.Array.keepMap</code> is in order here. This function takes two arguments:</p>
<ul><li>The name of the array to be traversed</li><li>A function that takes an item and returns <code>Some value</code> if the <code>value</code> is to be retained in the result, or <code>None</code> if the item is to be skipped.</li></ul>

<p><code>Belt.Array.keepMap</code> then applies the function to each item in the array, returning a new array consisting only of retained items.</p>
<a href="#challenge-1" id="challenge-1"><h3>Challenge 1</h3></a>

<p>The code you have seen here is a good example of an example. In a real school, a room might be used for several different courses. If you had added this entry to the <code>courses</code> array:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='6' id='block-6'><code><span data-type="course">{subject: <span class='string' data-type="string">&quot;Video Editing&quot;</span>, room: <span class='string' data-type="string">&quot;VPA203&quot;</span>, days: [| <span class='constructor' data-type="weekday">M</span>, <span class='constructor' data-type="weekday">T</span> |]}</span></code></pre>
  
  <script type='docre-source' data-block-id="6">#type weekday =
#  | M
#  | T
#  | W
#  | Th
#  | F;
#  
#type course = {
#  subject: string,
#  room: string,
#  days: array(weekday)
#};
#let courses = [|
#  {subject: "Math", room: "C101", days: [| M, W |]},
#  {subject: "Art", room: "VPA203", days: [| T, Th |]},
#  {subject: "Psychology", room: "A5-212", days: [|M, Th, F |]},
#|];
#
#let requested = [|T, W|];
#module DayComparator =
#  Belt.Id.MakeComparable(
#    {
#      type t = weekday;
#      let cmp = compare;
#    },
#  );
{subject: "Video Editing", room: "VPA203", days: [| M, T |]}</script>
  
</div>

<p>then <code>VPA203</code> would show up twice in the list of occupied rooms. You might want to write a different version of the code that uses a set of <code>string</code> to make sure the occupied room list doesn’t have duplicates.</p>
<a href="#challenge-2" id="challenge-2"><h3>Challenge 2</h3></a>

<p>Given a type that represents a fraction as a pair of integers,
write a comparator named <code>FracComparator</code> that lets you construct sets of fractions.
Your comparator should make sure that equivalent fractions like <code>(3, 4)</code> and <code>(9, 12)</code> are treated the same. This
challenge’s data type does not use variants, but if you write a comparator properly, it will work great.</p>
<p>Hint: to compare fractions <em>a</em>/<em>b</em> and <em>c</em>/<em>d</em>, compare <em>a</em> × <em>d</em> to <em>c</em> × <em>b</em>. For example, to compare 5/7 to 3/8, you would compare 5 × 8 to 3 × 7. Since 40 is greater than 20, that means 5/7 is greater than 3/8.</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='7' id='block-7'><code>type fraction = (<span class='type-constructor'>int</span>, <span class='type-constructor'>int</span>);
let <span class='pattern-ident' data-type="'a">s1</span> = <span class='ident' data-type="(
    array((int, int)),
    ~id: Belt.Set.id((int, int), 'a)
) => Belt.Set.t((int, int), 'a)">Belt.Set.fromArray</span>([| (<span class='int' data-type="int">5</span>, <span class='int' data-type="int">10</span>), (<span class='int' data-type="int">3</span>, <span class='int' data-type="int">4</span>), (<span class='int' data-type="int">5</span>, <span class='int' data-type="int">6</span>), (<span class='int' data-type="int">6</span>, <span class='int' data-type="int">12</span>) |],
  ~id=(module FracComparator));
let s2 = Belt.Set.fromArray([| (6, 8), (7, 12), (1, 3), (1, 2) |],
  ~id=(module FracComparator));
  
let both1 = Belt.Set.intersect(s1, s2);
let both2 = Belt.Set.intersect(s2, s1);

Js.log(Belt.Set.toArray(both1));
Js.log(Belt.Set.toArray(both2));</code></pre>
  
  <script type='docre-source' data-block-id="7">type fraction = (int, int);
let s1 = Belt.Set.fromArray([| (5, 10), (3, 4), (5, 6), (6, 12) |],
  ~id=(module FracComparator));
let s2 = Belt.Set.fromArray([| (6, 8), (7, 12), (1, 3), (1, 2) |],
  ~id=(module FracComparator));
  
let both1 = Belt.Set.intersect(s1, s2);
let both2 = Belt.Set.intersect(s2, s1);

Js.log(Belt.Set.toArray(both1));
Js.log(Belt.Set.toArray(both2));</script>
  <div class='type-error'>Type Error:\nFile &quot;&quot;, line 3, characters 14-28:
Error: Unbound module FracComparator</div>
</div>

<a href="#variants-with-constructors" id="variants-with-constructors"><h2>Variants With Constructors</h2></a>

<p>That’s great for simple variants, but what about a data type like this:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='8' id='block-8'><code>type colour = 
  | Red
  | Green
  | Blue
  | White
  | Black
  | Hex (<span class='type-constructor'>int</span>, <span class='type-constructor'>int</span>, <span class='type-constructor'>int</span>)
  | Named (<span class='type-constructor'>string</span>);</code></pre>
  
  <script type='docre-source' data-block-id="8">type colour = 
  | Red
  | Green
  | Blue
  | White
  | Black
  | Hex (int, int, int)
  | Named (string);</script>
  
</div><p>Can you make a <code>Belt.Set</code> of <code>colour</code>? Yes, you can. (Do you think I would be writing all of this just to tell you
that it can’t be done?) And, in fact, you don’t have to go to much extra effort, because it turns out that the
built-in <code>compare</code> function works like magic on these variants as well:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='9' id='block-9'><code><span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">Red</span>, <span class='constructor' data-type="colour">Blue</span>));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">White</span>, <span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">255</span>, <span class='int' data-type="int">0</span>, <span class='int' data-type="int">0</span>)));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">15</span>, <span class='int' data-type="int">20</span>, <span class='int' data-type="int">45</span>), <span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">15</span>, <span class='int' data-type="int">20</span>, <span class='int' data-type="int">30</span>)));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">15</span>, <span class='int' data-type="int">20</span>, <span class='int' data-type="int">45</span>), <span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">10</span>, <span class='int' data-type="int">20</span>, <span class='int' data-type="int">45</span>)));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">Named</span>(<span class='string' data-type="string">&quot;aqua&quot;</span>), <span class='constructor' data-type="colour">Hex</span>(<span class='int' data-type="int">128</span>, <span class='int' data-type="int">0</span>, <span class='int' data-type="int">255</span>)));
<span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="(colour, colour) => int">compare</span>(<span class='constructor' data-type="colour">Named</span>(<span class='string' data-type="string">&quot;beige&quot;</span>), <span class='constructor' data-type="colour">Named</span>(<span class='string' data-type="string">&quot;peach&quot;</span>)));</code></pre>
  
  <script type='docre-source' data-block-id="9">#type colour = 
#  | Red
#  | Green
#  | Blue
#  | White
#  | Black
#  | Hex (int, int, int)
#  | Named (string);
Js.log(compare(Red, Blue));
Js.log(compare(White, Hex(255, 0, 0)));
Js.log(compare(Hex(15, 20, 45), Hex(15, 20, 30)));
Js.log(compare(Hex(15, 20, 45), Hex(10, 20, 45)));
Js.log(compare(Named("aqua"), Hex(128, 0, 255)));
Js.log(compare(Named("beige"), Named("peach")));</script>
  <div data-block-id='9' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='9'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Block = window.packRequire("./node_modules/bs-platform/lib/js/block.js");
var Caml_obj = window.packRequire("./node_modules/bs-platform/lib/js/caml_obj.js");

console.log(Caml_obj.caml_compare(/* Red */0, /* Blue */2));

console.log(Caml_obj.caml_compare(/* White */3, /* Hex */Block.__(0, [
            255,
            0,
            0
          ])));

console.log(Caml_obj.caml_compare(/* Hex */Block.__(0, [
            15,
            20,
            45
          ]), /* Hex */Block.__(0, [
            15,
            20,
            30
          ])));

console.log(Caml_obj.caml_compare(/* Hex */Block.__(0, [
            15,
            20,
            45
          ]), /* Hex */Block.__(0, [
            10,
            20,
            45
          ])));

console.log(Caml_obj.caml_compare(/* Named */Block.__(1, ["aqua"]), /* Hex */Block.__(0, [
            128,
            0,
            255
          ])));

console.log(Caml_obj.caml_compare(/* Named */Block.__(1, ["beige"]), /* Named */Block.__(1, ["peach"])));

/*  Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_9.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_9.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div>

<p>So, the comparator function for a set of <code>colour</code> can use the built-in <code>compare</code> and achieve acceptable results:</p>
<div class='code-block'>
  
  <pre class='code' data-block-id='10' id='block-10'><code>module ColourComparator =
  Belt.Id.MakeComparable(
    {
      type t = <span class='type-constructor'>colour</span>;
      let <span class='pattern-ident' data-type="('a, 'a) => int">cmp</span> = <span class='ident' data-type="('a, 'a) => int">compare</span>;
    },
  );

module Set = Belt.Set;

let <span class='pattern-ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset1</span> = <span class='ident' data-type="(
    array(ColourComparator.t),
    ~id: Set.id(
        ColourComparator.t,
        ColourComparator.identity
    )
) => Set.t(ColourComparator.t, ColourComparator.identity)">Set.fromArray</span>([|<span class='constructor' data-type="ColourComparator.t">White</span>, <span class='constructor' data-type="ColourComparator.t">Red</span>, <span class='constructor' data-type="ColourComparator.t">Hex</span>(<span class='int' data-type="int">255</span>, <span class='int' data-type="int">255</span>, <span class='int' data-type="int">0</span>), <span class='constructor' data-type="ColourComparator.t">Named</span>(<span class='string' data-type="string">&quot;lime&quot;</span>)|],
  ~id = (module ColourComparator));
let <span class='pattern-ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset2</span> = <span class='ident' data-type="(
    array(ColourComparator.t),
    ~id: Set.id(
        ColourComparator.t,
        ColourComparator.identity
    )
) => Set.t(ColourComparator.t, ColourComparator.identity)">Set.fromArray</span>([|<span class='constructor' data-type="ColourComparator.t">Green</span>, <span class='constructor' data-type="ColourComparator.t">Red</span>, <span class='constructor' data-type="ColourComparator.t">Hex</span>(<span class='int' data-type="int">0</span>, <span class='int' data-type="int">128</span>,<span class='int' data-type="int">0</span>)|],
  ~id = (module ColourComparator));
let <span class='pattern-ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset3</span> = <span class='ident' data-type="(
    Set.t(ColourComparator.t, ColourComparator.identity),
    ColourComparator.t
) => Set.t(ColourComparator.t, ColourComparator.identity)">Set.add</span>(<span class='ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset2</span>, <span class='constructor' data-type="ColourComparator.t">Named</span>(<span class='string' data-type="string">&quot;lime&quot;</span>));
<span class='ident' data-type="array(ColourComparator.t) => unit">Js.log</span>(<span class='ident' data-type="Set.t(
    ColourComparator.t,
    ColourComparator.identity
) => array(ColourComparator.t)">Set.toArray</span>(<span class='ident' data-type="(
    Set.t(ColourComparator.t, ColourComparator.identity),
    Set.t(
        ColourComparator.t,
        ColourComparator.identity
    )
) => Set.t(ColourComparator.t, ColourComparator.identity)">Set.intersect</span>(<span class='ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset1</span>, <span class='ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset3</span>)));
<span class='ident' data-type="array(ColourComparator.t) => unit">Js.log</span>(<span class='ident' data-type="(
    Set.t(ColourComparator.t, ColourComparator.identity),
    Set.t(
        ColourComparator.t,
        ColourComparator.identity
    )
) => Set.t(ColourComparator.t, ColourComparator.identity)">Set.diff</span>(<span class='ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset1</span>, <span class='ident' data-type="Set.t(ColourComparator.t, ColourComparator.identity)">cset3</span>) <span class='operator' data-type="(
    Set.t(ColourComparator.t, ColourComparator.identity),
    Set.t(
        ColourComparator.t,
        ColourComparator.identity
    ) => array(ColourComparator.t)
) => array(ColourComparator.t)">|&gt;</span> <span class='ident' data-type="Set.t(
    ColourComparator.t,
    ColourComparator.identity
) => array(ColourComparator.t)">Set.toArray</span>); /* easier notation */</code></pre>
  
  <script type='docre-source' data-block-id="10">#type colour = 
#  | Red
#  | Green
#  | Blue
#  | White
#  | Black
#  | Hex (int, int, int)
#  | Named (string);
module ColourComparator =
  Belt.Id.MakeComparable(
    {
      type t = colour;
      let cmp = compare;
    },
  );

module Set = Belt.Set;

let cset1 = Set.fromArray([|White, Red, Hex(255, 255, 0), Named("lime")|],
  ~id = (module ColourComparator));
let cset2 = Set.fromArray([|Green, Red, Hex(0, 128,0)|],
  ~id = (module ColourComparator));
let cset3 = Set.add(cset2, Named("lime"));
Js.log(Set.toArray(Set.intersect(cset1, cset3)));
Js.log(Set.diff(cset1, cset3) |> Set.toArray); /* easier notation */</script>
  <div data-block-id='10' data-context="normal" class='block-target'></div><script type='docre-bundle' data-block-id='10'>
;(function() { // generated by pack.re
let modules = {}
let initializers = {
    1: function(module, exports, require) {// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var Block = window.packRequire("./node_modules/bs-platform/lib/js/block.js");
var Belt_Id = window.packRequire("./node_modules/bs-platform/lib/js/belt_Id.js");
var Belt_Set = window.packRequire("./node_modules/bs-platform/lib/js/belt_Set.js");
var Caml_obj = window.packRequire("./node_modules/bs-platform/lib/js/caml_obj.js");

var cmp = Caml_obj.caml_compare;

var ColourComparator = Belt_Id.MakeComparable(/* module */[/* cmp */cmp]);

var cset1 = Belt_Set.fromArray(/* array */[
      /* White */3,
      /* Red */0,
      /* Hex */Block.__(0, [
          255,
          255,
          0
        ]),
      /* Named */Block.__(1, ["lime"])
    ], ColourComparator);

var cset2 = Belt_Set.fromArray(/* array */[
      /* Green */1,
      /* Red */0,
      /* Hex */Block.__(0, [
          0,
          128,
          0
        ])
    ], ColourComparator);

var cset3 = Belt_Set.add(cset2, /* Named */Block.__(1, ["lime"]));

console.log(Belt_Set.toArray(Belt_Set.intersect(cset1, cset3)));

console.log(Belt_Set.toArray(Belt_Set.diff(cset1, cset3)));

var $$Set = 0;

exports.ColourComparator = ColourComparator;
exports.$$Set = $$Set;
exports.cset1 = cset1;
exports.cset2 = cset2;
exports.cset3 = cset3;
/* ColourComparator Not a pure module */
//# sourceURL=./node_modules/.docre/DOCRE_CODE_BLOCK_10.re_ppx.js
}
};
let nameMap = {
  "./node_modules/.docre/DOCRE_CODE_BLOCK_10.re_ppx.js": 1
}
let require = (id) => {
  if (!modules[id]) {
    modules[id] = {exports: {}}
    initializers[id](modules[id], modules[id].exports, require)
  }
  return modules[id].exports
};
  require(1)})();</script>
</div>

<a href="#conclusion" id="conclusion"><h2>Conclusion</h2></a>

<p>You can use your own variant data types in sets by:</p>
<ul><li>Creating a comparison function that returns -1, 0, and 1 for your criteria of less than, equal, and greater than.</li><li>Use that comparison in a comparator <code>module</code></li><li>Specify that comparator when creating a <code>Belt.Set</code></li></ul>
    </div>
    <div class='right-blank'></div>
    </div>
  